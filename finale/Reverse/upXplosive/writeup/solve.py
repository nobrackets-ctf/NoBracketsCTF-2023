target = "NBCTF{b4SIc_P@cK1ng_W1TH_upX}"

key = [0x24, 0x29, 0x0a, 0x1e, 0xa8, 0xfe, 0x85, 0x25, 0x26, 0x0c, 0x1a, 0x8b, 0xc7, 0x3e, 0xac, 0x22]
cipher = [0x28, 0x43, 0x57, 0x91, 0x96, 0x13, 0x6c, 0x7d, 0x9f, 0x62, 0x1b, 0x76, 0xe1, 0xbd, 0xbb, 0x90, 0x85, 0xc1, 0x7b, 0x9c, 0x63, 0x2e, 0xff, 0x93, 0xab, 0x8e, 0xe4, 0x37, 0xb]

"""
unsigned char old = 0x42;
    
for (size_t i = 0; i < len; i++) {
    if (old%2) input[i] += (key[i % (sizeof(key) / sizeof(key[0]))] << 1) | i&1;
    else input[i] ^ key[i % (sizeof(key) / sizeof(key[0]))] ^ old;
}
"""
plain = ""
old = 0x42
for i,c in enumerate(cipher):
    if old%2 : plain += chr((c - (key[i % len(key)] << 1 | i&1)) %256 )
    else : plain += chr(c ^ key[i % len(key)] ^ old)
    old = c

assert(target == plain)
print(plain)