from Crypto.Cipher import AES
import hashlib

def decrypt_flag(cle_privee: int, iv: str, ciphertext : str):
    sha1 = hashlib.sha1()
    sha1.update(str(cle_privee).encode("utf-8"))
    key = sha1.digest()[:16]

    ciphertext = bytes.fromhex(ciphertext)
    iv = bytes.fromhex(iv)
    cipher = AES.new(key, AES.MODE_CBC, iv)
    plaintext = cipher.decrypt(ciphertext)

    print(plaintext)

p = 108121549662201782130676129598529179030520756985633271272953227752846409907053

A = 65433381908822513175277700580025513600754502844563968587025735911781285255711
B = 47630014423222428100074321337075146303830322492423683023362586408169931347123
C = 75931233012682531484724194240908656688848889111093204554327467877434167311636

Bc = 69748933305158300089685585514758323274735187629096317871676023451584552018338
Ba = 107703993535038092994940642577638176303978318702980937103621685443831514096874

iv = "91798f0751585bf448c2bd667c0373f0"
ciphertext = "c3facb2dc6ca8fb1b2c716ff88d1b23323dc1866d92d2eee802841a3ad12c7a61f2e77835187fb4615b95099e6b67004"

K = (Ba*Bc) % p
decrypt_flag(K,iv,ciphertext)